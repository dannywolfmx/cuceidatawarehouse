!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.universe=n()}}(function(){var n;return function e(n,t,r){function i(o,c){if(!t[o]){if(!n[o]){var a="function"==typeof require&&require;if(!c&&a)return a(o,!0);if(u)return u(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[o]={exports:{}};n[o][0].call(f.exports,function(e){var t=n[o][1][e];return i(t?t:e)},f,f.exports,e,n,t,r)}return t[o].exports}for(var u="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(n,e,t){!function(n){function e(n){return n}function t(n,e,t){for(var r=0,i=e.length,u=t?JSON.parse(JSON.stringify(n)):new Array(i);i>r;++r)u[r]=n[e[r]];return u}function r(n){function e(e,t,r,i){for(;i>r;){var u=r+i>>>1;n(e[u])<t?r=u+1:i=u}return r}function t(e,t,r,i){for(;i>r;){var u=r+i>>>1;t<n(e[u])?i=u:r=u+1}return r}return t.right=t,t.left=e,t}function u(n){function e(n,e,t){for(var i=t-e,u=(i>>>1)+1;--u>0;)r(n,u,i,e);return n}function t(n,e,t){for(var i,u=t-e;--u>0;)i=n[e],n[e]=n[e+u],n[e+u]=i,r(n,1,u,e);return n}function r(e,t,r,i){for(var u,o=e[--i+t],c=n(o);(u=t<<1)<=r&&(r>u&&n(e[i+u])>n(e[i+u+1])&&u++,!(c<=n(e[i+u])));)e[i+t]=e[i+u],t=u;e[i+t]=o}return e.sort=t,e}function o(n){function e(e,r,i,u){var o,c,a,s,f=new Array(u=Math.min(i-r,u));for(c=0;u>c;++c)f[c]=e[r++];if(t(f,0,u),i>r){o=n(f[0]);do(a=n(s=e[r])>o)&&(f[0]=s,o=n(t(f,0,u)[0]));while(++r<i)}return f}var t=u(n);return e}function c(n){function e(e,t,r){for(var i=t+1;r>i;++i){for(var u=i,o=e[i],c=n(o);u>t&&n(e[u-1])>c;--u)e[u]=e[u-1];e[u]=o}return e}return e}function a(n){function e(n,e,i){return(T>i-e?r:t)(n,e,i)}function t(t,r,i){var u,o=(i-r)/6|0,c=r+o,a=i-1-o,s=r+i-1>>1,f=s-o,l=s+o,d=t[c],p=n(d),v=t[f],h=n(v),m=t[s],y=n(m),g=t[l],x=n(g),k=t[a],b=n(k);p>h&&(u=d,d=v,v=u,u=p,p=h,h=u),x>b&&(u=g,g=k,k=u,u=x,x=b,b=u),p>y&&(u=d,d=m,m=u,u=p,p=y,y=u),h>y&&(u=v,v=m,m=u,u=h,h=y,y=u),p>x&&(u=d,d=g,g=u,u=p,p=x,x=u),y>x&&(u=m,m=g,g=u,u=y,y=x,x=u),h>b&&(u=v,v=k,k=u,u=h,h=b,b=u),h>y&&(u=v,v=m,m=u,u=h,h=y,y=u),x>b&&(u=g,g=k,k=u,u=x,x=b,b=u);var j=v,w=h,A=g,O=x;t[c]=d,t[f]=t[r],t[s]=m,t[l]=t[i-1],t[a]=k;var L=r+1,S=i-2,R=O>=w&&w>=O;if(R)for(var q=L;S>=q;++q){var E=t[q],$=n(E);if(w>$)q!==L&&(t[q]=t[L],t[L]=E),++L;else if($>w)for(;;){var I=n(t[S]);{if(!(I>w)){if(w>I){t[q]=t[L],t[L++]=t[S],t[S--]=E;break}t[q]=t[S],t[S--]=E;break}S--}}}else for(var q=L;S>=q;q++){var E=t[q],$=n(E);if(w>$)q!==L&&(t[q]=t[L],t[L]=E),++L;else if($>O)for(;;){var I=n(t[S]);{if(!(I>O)){w>I?(t[q]=t[L],t[L++]=t[S],t[S--]=E):(t[q]=t[S],t[S--]=E);break}if(S--,q>S)break}}}if(t[r]=t[L-1],t[L-1]=j,t[i-1]=t[S+1],t[S+1]=A,e(t,r,L-1),e(t,S+2,i),R)return t;if(c>L&&S>a){for(var T,I;(T=n(t[L]))<=w&&T>=w;)++L;for(;(I=n(t[S]))<=O&&I>=O;)--S;for(var q=L;S>=q;q++){var E=t[q],$=n(E);if(w>=$&&$>=w)q!==L&&(t[q]=t[L],t[L]=E),L++;else if(O>=$&&$>=O)for(;;){var I=n(t[S]);{if(!(O>=I&&I>=O)){w>I?(t[q]=t[L],t[L++]=t[S],t[S--]=E):(t[q]=t[S],t[S--]=E);break}if(S--,q>S)break}}}}return e(t,L,S+1)}var r=c(n);return e}function s(n){for(var e=new Array(n),t=-1;++t<n;)e[t]=0;return e}function f(n,e){for(var t=n.length;e>t;)n[t++]=0;return n}function d(n,e){if(e>32)throw new Error("invalid array width!");return n}function p(n){this.length=n,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=C(n)}function v(n,e){return function(t){var r=t.length;return[n.left(t,e,0,r),n.right(t,e,0,r)]}}function h(n,e){var t=e[0],r=e[1];return function(e){var i=e.length;return[n.left(e,t,0,i),n.left(e,r,0,i)]}}function m(n){return[0,n.length]}function y(){return null}function g(){return 0}function x(n){return n+1}function b(n){return n-1}function j(n){return function(e,t){return e+ +n(t)}}function w(n){return function(e,t){return e-n(t)}}function A(){function n(n){var e=T,t=n.length;return t&&(I=I.concat(n),E.lengthen(T+=t),P.forEach(function(r){r(n,e,t)}),q("dataAdded")),$}function r(){for(var n=O(T,T),e=[],t=0,r=0;T>t;++t)E.zero(t)?e.push(t):n[t]=r++;C.forEach(function(n){n(-1,-1,[],e,!0)}),N.forEach(function(e){e(n)});for(var t=0,r=0;T>t;++t)E.zero(t)||(t!==r&&(E.copy(r,t),I[r]=I[t]),++r);I.length=T=r,E.truncate(r),q("dataRemoved")}function c(n,r){function c(e,u,o){if(r){for(yn=0,v=0,k=[],i=0;i<e.length;i++)for(v=0,k=n(e[i]);v<k.length;v++)yn++;nn=[],rn=L(e.length),on=O(yn,1),an=[];var c=L(yn);for(l=0,i=0;i<e.length;i++)if(k=n(e[i]),k.length)for(rn[i]=k.length,v=0;v<k.length;v++)nn.push(k[v]),c[l]=i,l++;else rn[i]=0,an.push(i);var a=ln(L(yn),0,yn);nn=t(nn,a),en=t(c,a)}else nn=e.map(n),en=ln(L(o),0,o),nn=t(nn,en);r&&(o=yn);var s=dn(nn),f=s[0],d=s[1];if(sn)for(i=0;i<o;++i)sn(nn[i],i)||(E[G][en[i]+u]|=Q,r&&(on[i]=1));else{for(i=0;i<f;++i)E[G][en[i]+u]|=Q,r&&(on[i]=1);for(i=d;i<o;++i)E[G][en[i]+u]|=Q,r&&(on[i]=1)}if(!u)return H=nn,X=en,tn=rn,un=on,hn=f,void(mn=d);if(W=H,Z=X,cn=un,i0=0,i1=0,r&&(old_n0=u,u=W.length,o=yn),H=r?new Array(u+o):new Array(T),X=r?new Array(u+o):O(T,T),r&&(un=O(u+o,1)),r){var p=tn.length;tn=z(tn,T);for(var v=0;T>v+p;v++)tn[v+p]=rn[v]}for(i=0;i0<u&&i1<o;++i)W[i0]<nn[i1]?(H[i]=W[i0],r&&(un[i]=cn[i0]),X[i]=Z[i0++]):(H[i]=nn[i1],r&&(un[i]=cn[i1]),X[i]=en[i1++]+(r?old_n0:u));for(;i0<u;++i0,++i)H[i]=W[i0],r&&(un[i]=cn[i0]),X[i]=Z[i0];for(;i1<o;++i1,++i)H[i]=nn[i1],r&&(un[i]=cn[i1]),X[i]=en[i1]+(r?old_n0:u);s=dn(H),hn=s[0],mn=s[1]}function s(n,e,t){pn.forEach(function(n){n(nn,en,e,t)}),nn=en=null}function f(n){for(var e,t=0,r=0;T>t;++t)E.zero(e=X[t])||(t!==r&&(H[r]=H[t]),X[r]=n[e],++r);for(H.length=r;T>r;)X[r++]=0;var i=dn(H);hn=i[0],mn=i[1]}function d(n){var e=n[0],t=n[1];if(sn)return sn=null,B(function(n,r){return r>=e&&t>r},0===n[0]&&n[1]===X.length),hn=e,mn=t,fn;var i,u,o,c=[],a=[],s=[],f=[];if(hn>e)for(i=e,u=Math.min(hn,t);u>i;++i)c.push(X[i]),s.push(i);else if(e>hn)for(i=hn,u=Math.min(e,mn);u>i;++i)a.push(X[i]),f.push(i);if(t>mn)for(i=Math.max(e,mn),u=t;u>i;++i)c.push(X[i]),s.push(i);else if(mn>t)for(i=Math.max(hn,t),u=mn;u>i;++i)a.push(X[i]),f.push(i);if(r){var l=[],d=[];for(i=0;i<c.length;i++)tn[c[i]]++,un[s[i]]=0,1===tn[c[i]]&&(E[G][c[i]]^=Q,l.push(c[i]));for(i=0;i<a.length;i++)tn[a[i]]--,un[f[i]]=1,0===tn[a[i]]&&(E[G][a[i]]^=Q,d.push(a[i]));if(c=l,a=d,0===n[0]&&n[1]===X.length)for(i=0;i<an.length;i++)E[G][o=an[i]]&Q&&(E[G][o]^=Q,c.push(o));else for(i=0;i<an.length;i++)E[G][o=an[i]]&Q||(E[G][o]^=Q,a.push(o))}else{for(i=0;i<c.length;i++)E[G][c[i]]^=Q;for(i=0;i<a.length;i++)E[G][a[i]]^=Q}return hn=e,mn=t,C.forEach(function(n){n(Q,G,c,a)}),q("filtered"),fn}function p(n){return null==n?U():Array.isArray(n)?$(n):"function"==typeof n?M(n):A(n)}function A(n){return d((dn=v(R,n))(H))}function $(n){return d((dn=h(R,n))(H))}function U(){return d((dn=m)(H))}function M(n){return dn=m,B(sn=n,!1),hn=0,mn=T,fn}function B(n,e){var t,i,u,o=[],c=[],a=[],s=[],f=X.length;if(!r)for(t=0;f>t;++t)!(E[G][i=X[t]]&Q)^!!(u=n(H[t],t))&&(u?o.push(i):c.push(i));if(r)for(t=0;f>t;++t)n(H[t],t)?(o.push(X[t]),a.push(t)):(c.push(X[t]),s.push(t));if(r){var l=[],d=[];for(t=0;t<o.length;t++)1===un[a[t]]&&(tn[o[t]]++,un[a[t]]=0,1===tn[o[t]]&&(E[G][o[t]]^=Q,l.push(o[t])));for(t=0;t<c.length;t++)0===un[s[t]]&&(tn[c[t]]--,un[s[t]]=1,0===tn[c[t]]&&(E[G][c[t]]^=Q,d.push(c[t])));if(o=l,c=d,e)for(t=0;t<an.length;t++)E[G][i=an[t]]&Q&&(E[G][i]^=Q,o.push(i));else for(t=0;t<an.length;t++)E[G][i=an[t]]&Q||(E[G][i]^=Q,c.push(i))}else{for(t=0;t<o.length;t++)E[G][o[t]]&Q&&(E[G][o[t]]&=Y);for(t=0;t<c.length;t++)E[G][c[t]]&Q||(E[G][c[t]]|=Q)}C.forEach(function(n){n(Q,G,o,c)}),q("filtered")}function K(n){for(var e,t=[],i=mn;--i>=hn&&n>0;)E.zero(e=X[i])&&(t.push(I[e]),--n);if(r)for(i=0;i<an.length&&n>0;i++)E.zero(e=an[i])&&(t.push(I[e]),--n);return t}function D(n){var e,t,i=[];if(r)for(e=0;e<an.length&&n>0;e++)E.zero(t=an[e])&&(i.push(I[t]),--n);for(e=hn;mn>e&&n>0;)E.zero(t=X[e])&&(i.push(I[t]),--n),e++;return i}function V(n){function c(e,u,o,c){function a(){return r?void W++:void(++W===J&&(b=F(b,_<<=1),U=F(U,_),J=S(_)))}r&&(n0old=o,o=H.length-e.length,c=e.length);var p,v,h,m,g,x,k=P,b=r?[]:O(W,J),j=K,w=D,A=V,L=W,R=0,q=0;for(en&&(j=A=y),en&&(w=A=y),P=new Array(W),W=0,U=r?L>1?U:[]:L>1?z(U,T):O(T,J),L&&(h=(v=k[0]).key);c>q&&!((m=n(e[q]))>=m);)++q;for(;c>q;){for(v&&m>=h?(g=v,x=h,b[R]=W,(v=k[++R])&&(h=v.key)):(g={key:m,value:A()},x=m),P[W]=g;x>=m&&(p=u[q]+(r?n0old:o),r?U[p]?U[p].push(W):U[p]=[W]:U[p]=W,g.value=j(g.value,I[p],!0),E.zeroExcept(p,G,Y)||(g.value=w(g.value,I[p],!1)),!(++q>=c));)m=n(e[q]);a()}for(;L>R;)P[b[R]=W]=k[R++],a();if(r)for(i=0;i<T;i++)U[i]||(U[i]=[]);if(W>R)if(r)U=t(U,b,!0);else for(R=0;o>R;++R)U[R]=b[U[R]];p=C.indexOf(Z),W>1?(Z=s,nn=l):(!W&&tn&&(W=1,P=[{key:null,value:A()}]),1===W?(Z=f,nn=d):(Z=y,nn=y),U=null),C[p]=Z}function a(){if(W>1){for(var n=W,e=P,t=O(n,n),r=0,i=0;T>r;++r)E.zero(r)||(t[U[i]=U[r]]=1,++i);for(P=[],W=0,r=0;n>r;++r)t[r]&&(t[r]=W++,P.push(e[r]));if(W>1)for(var r=0;i>r;++r)U[r]=t[U[r]];else U=null;C[C.indexOf(Z)]=W>1?(nn=l,Z=s):1===W?(nn=d,Z=f):nn=Z=y}else if(1===W){if(tn)return;for(var r=0;T>r;++r)if(!E.zero(r))return;P=[],W=0,C[C.indexOf(Z)]=Z=nn=y}}function s(n,e,t,i,u){if(!(n===Q&&e===G||en)){var o,c,a,s,f;if(r){for(o=0,s=t.length;s>o;++o)if(E.zeroExcept(a=t[o],G,Y))for(c=0;c<U[a].length;c++)f=P[U[a][c]],f.value=K(f.value,I[a],!1,c);for(o=0,s=i.length;s>o;++o)if(E.onlyExcept(a=i[o],G,Y,e,n))for(c=0;c<U[a].length;c++)f=P[U[a][c]],f.value=D(f.value,I[a],u,c)}else{for(o=0,s=t.length;s>o;++o)E.zeroExcept(a=t[o],G,Y)&&(f=P[U[a]],f.value=K(f.value,I[a],!1));for(o=0,s=i.length;s>o;++o)E.onlyExcept(a=i[o],G,Y,e,n)&&(f=P[U[a]],f.value=D(f.value,I[a],u))}}}function f(n,e,t,r,i){if(!(n===Q&&e===G||en)){var u,o,c,a=P[0];for(u=0,c=t.length;c>u;++u)E.zeroExcept(o=t[u],G,Y)&&(a.value=K(a.value,I[o],!1));for(u=0,c=r.length;c>u;++u)E.onlyExcept(o=r[u],G,Y,e,n)&&(a.value=D(a.value,I[o],i))}}function l(){var n,e,t;for(n=0;W>n;++n)P[n].value=V();if(r){for(n=0;T>n;++n)for(e=0;e<U[n].length;e++)t=P[U[n][e]],t.value=K(t.value,I[n],!0,e);for(n=0;T>n;++n)if(!E.zeroExcept(n,G,Y))for(e=0;e<U[n].length;e++)t=P[U[n][e]],t.value=D(t.value,I[n],!1,e)}else{for(n=0;T>n;++n)t=P[U[n]],t.value=K(t.value,I[n],!0);for(n=0;T>n;++n)E.zeroExcept(n,G,Y)||(t=P[U[n]],t.value=D(t.value,I[n],!1))}}function d(){var n,e=P[0];for(e.value=V(),n=0;T>n;++n)e.value=K(e.value,I[n],!0);for(n=0;T>n;++n)E.zeroExcept(n,G,Y)||(e.value=D(e.value,I[n],!1))}function p(){return en&&(nn(),en=!1),P}function v(n){var e=M(p(),0,P.length,n);return B.sort(e,0,e.length)}function h(n,e,t){return K=n,D=e,V=t,en=!0,$}function m(){return h(x,b,g)}function k(n){return h(j(n),w(n),g)}function A(n){function e(e){return n(e.value)}return M=o(e),B=u(e),$}function L(){return A(e)}function R(){return W}function q(){var n=C.indexOf(Z);return n>=0&&C.splice(n,1),n=pn.indexOf(c),n>=0&&pn.splice(n,1),n=N.indexOf(a),n>=0&&N.splice(n,1),$}var $={top:v,all:p,reduce:h,reduceCount:m,reduceSum:k,order:A,orderNatural:L,size:R,dispose:q,remove:q};vn.push($);var P,U,M,B,K,D,V,_=8,J=S(_),W=0,Z=y,nn=y,en=!0,tn=n===y;return arguments.length<1&&(n=e),C.push(Z),pn.push(c),N.push(a),c(H,X,0,T),m().orderNatural()}function _(){var n=V(y),e=n.all;return delete n.all,delete n.top,delete n.order,delete n.orderNatural,delete n.size,n.value=function(){return e()[0].value},n}function J(){vn.forEach(function(n){n.dispose()});var n=P.indexOf(c);return n>=0&&P.splice(n,1),n=P.indexOf(s),n>=0&&P.splice(n,1),n=N.indexOf(f),n>=0&&N.splice(n,1),E.masks[G]&=Y,U()}var Q,Y,G,H,X,W,Z,nn,en,tn,rn,un,on,cn,an,sn,fn={filter:p,filterExact:A,filterRange:$,filterFunction:M,filterAll:U,top:K,bottom:D,group:V,groupAll:_,dispose:J,remove:J},ln=a(function(n){return nn[n]}),dn=m,pn=[],vn=[],hn=0,mn=0,yn=0;P.unshift(c),P.push(s),N.push(f);var gn=E.add();return G=gn.offset,Q=gn.one,Y=~Q,c(I,0,T),s(I,0,T),fn}function s(){function n(n,e){var t;if(!p)for(t=e;T>t;++t)a=s(a,I[t],!0),E.zero(t)||(a=f(a,I[t],!1))}function e(n,e,t,r,i){var u,o,c;if(!p){for(u=0,c=t.length;c>u;++u)E.zero(o=t[u])&&(a=s(a,I[o],i));for(u=0,c=r.length;c>u;++u)E.only(o=r[u],e,n)&&(a=f(a,I[o],i))}}function t(){var n;for(a=l(),n=0;T>n;++n)a=s(a,I[n],!0),E.zero(n)||(a=f(a,I[n],!1))}function r(n,e,t){return s=n,f=e,l=t,p=!0,d}function i(){return r(x,b,g)}function u(n){return r(j(n),w(n),g)}function o(){return p&&(t(),p=!1),a}function c(){var t=C.indexOf(e);return t>=0&&C.splice(t),t=P.indexOf(n),t>=0&&P.splice(t),d}var a,s,f,l,d={reduce:r,reduceCount:i,reduceSum:u,value:o,dispose:c,remove:c},p=!0;return C.push(e),P.push(n),n(I,0,T),i()}function f(){return T}function d(){return I}function A(n){return"function"!=typeof n?void console.warn("onChange callback parameter must be a function!"):(U.push(n),function(){U.splice(U.indexOf(n),1)})}function q(n){for(var e=0;e<U.length;e++)U[e](n)}var E,$={add:n,remove:r,dimension:c,groupAll:s,size:f,all:d,onChange:A},I=[],T=0,C=[],P=[],N=[],U=[];return E=new p(0),arguments.length?n(arguments[0]):$}function O(n,e){return(257>e?C:65537>e?P:N)(n)}function L(n){for(var e=O(n,n),t=-1;++t<n;)e[t]=t;return e}function S(n){return 8===n?256:16===n?65536:4294967296}A.version="2.0.0-alpha.03",A.permute=t;var R=A.bisect=r(e);R.by=r;var q=A.heap=u(e);q.by=u;var E=A.heapselect=o(e);E.by=o;var $=A.insertionsort=c(e);$.by=c;var I=A.quicksort=a(e);I.by=a;var T=32,C=s,P=s,N=s,z=f,F=d;"undefined"!=typeof Uint8Array&&(C=function(n){return new Uint8Array(n)},P=function(n){return new Uint16Array(n)},N=function(n){return new Uint32Array(n)},z=function(n,e){if(n.length>=e)return n;var t=new n.constructor(e);return t.set(n),t},F=function(n,e){var t;switch(e){case 16:t=P(n.length);break;case 32:t=N(n.length);break;default:throw new Error("invalid array width!")}return t.set(n),t}),p.prototype.lengthen=function(n){var e,t;for(e=0,t=this.subarrays;t>e;++e)this[e]=z(this[e],n);this.length=n},p.prototype.add=function(){var n,e,t,r,i;for(r=0,i=this.subarrays;i>r;++r)if(n=this.masks[r],e=this.width-32*r,t=~n&-~n,!(e>=32)||t)return 32>e&&t&1<<e&&(this[r]=F(this[r],e<<=1),this.width=32*r+e),this.masks[r]|=t,{offset:r,one:t};return this[this.subarrays]=C(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},p.prototype.copy=function(n,e){var t,r;for(t=0,r=this.subarrays;r>t;++t)this[t][n]=this[t][e]},p.prototype.truncate=function(n){var e,t;for(e=0,t=this.subarrays;t>e;++e){for(var r=this.length-1;r>=n;r--)this[e][r]=0;this[e].length=n}this.length=n},p.prototype.zero=function(n){var e,t;for(e=0,t=this.subarrays;t>e;++e)if(this[e][n])return!1;return!0},p.prototype.zeroExcept=function(n,e,t){var r,i;for(r=0,i=this.subarrays;i>r;++r)if(r===e?this[r][n]&t:this[r][n])return!1;return!0},p.prototype.only=function(n,e,t){var r,i;for(r=0,i=this.subarrays;i>r;++r)if(this[r][n]!=(r===e?t:0))return!1;return!0},p.prototype.onlyExcept=function(n,e,t,r,i){var u,o,c;for(o=0,c=this.subarrays;c>o;++o)if(u=this[o][n],o===e&&(u&=t),u!=(o===r?i:0))return!1;return!0},n.crossfilter=A}("undefined"!=typeof t&&t||this)},{}],2:[function(n,e,t){e.exports=n("./crossfilter").crossfilter},{"./crossfilter":1}],3:[function(n,e,t){function r(){f=!1,c.length?s=c.concat(s):l=-1,s.length&&i()}function i(){if(!f){var n=setTimeout(r);f=!0;for(var e=s.length;e;){for(c=s,s=[];++l<e;)c&&c[l].run();l=-1,e=s.length}c=null,f=!1,clearTimeout(n)}}function u(n,e){this.fun=n,this.array=e}function o(){}var c,a=e.exports={},s=[],f=!1,l=-1;a.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new u(n,e)),1!==s.length||f||setTimeout(i,0)},u.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=o,a.addListener=o,a.once=o,a.off=o,a.removeListener=o,a.removeAllListeners=o,a.emit=o,a.binding=function(n){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(n){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],4:[function(e,t,r){(function(e){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof r&&"object"==typeof t)t.exports=e();else if("function"==typeof n&&n.amd)n(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var i="undefined"!=typeof window?window:self,u=i.Q;i.Q=e(),i.Q.noConflict=function(){return i.Q=u,this}}}(function(){"use strict";function n(n){return function(){return G.apply(n,arguments)}}function t(n){return n===Object(n)}function r(n){return"[object StopIteration]"===rn(n)||n instanceof _}function i(n,e){if(K&&e.stack&&"object"==typeof n&&null!==n&&n.stack&&-1===n.stack.indexOf(un)){for(var t=[],r=e;r;r=r.source)r.stack&&t.unshift(r.stack);t.unshift(n.stack);var i=t.join("\n"+un+"\n");n.stack=u(i)}}function u(n){for(var e=n.split("\n"),t=[],r=0;r<e.length;++r){var i=e[r];a(i)||o(i)||!i||t.push(i)}return t.join("\n")}function o(n){return-1!==n.indexOf("(module.js:")||-1!==n.indexOf("(node.js:")}function c(n){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(n);if(e)return[e[1],Number(e[2])];var t=/at ([^ ]+):(\d+):(?:\d+)$/.exec(n);if(t)return[t[1],Number(t[2])];var r=/.*@(.+):(\d+)$/.exec(n);return r?[r[1],Number(r[2])]:void 0}function a(n){var e=c(n);if(!e)return!1;var t=e[0],r=e[1];return t===V&&r>=J&&fn>=r}function s(){if(K)try{throw new Error}catch(n){var e=n.stack.split("\n"),t=e[0].indexOf("@")>0?e[1]:e[2],r=c(t);if(!r)return;return V=r[0],r[1]}}function f(n,e,t){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+t+" instead.",new Error("").stack),n.apply(n,arguments)}}function l(n){return n instanceof h?n:x(n)?R(n):S(n)}function d(){function n(n){e=n,u.source=n,X(t,function(e,t){l.nextTick(function(){n.promiseDispatch.apply(n,t)})},void 0),t=void 0,r=void 0}var e,t=[],r=[],i=nn(d.prototype),u=nn(h.prototype);if(u.promiseDispatch=function(n,i,u){var o=H(arguments);t?(t.push(o),"when"===i&&u[1]&&r.push(u[1])):l.nextTick(function(){e.promiseDispatch.apply(e,o)})},u.valueOf=function(){if(t)return u;var n=y(e);return g(n)&&(e=n),n},u.inspect=function(){return e?e.inspect():{state:"pending"}},l.longStackSupport&&K)try{throw new Error}catch(o){u.stack=o.stack.substring(o.stack.indexOf("\n")+1)}return i.promise=u,i.resolve=function(t){e||n(l(t))},i.fulfill=function(t){e||n(S(t))},i.reject=function(t){e||n(L(t))},i.notify=function(n){e||X(r,function(e,t){l.nextTick(function(){t(n)})},void 0)},i}function p(n){if("function"!=typeof n)throw new TypeError("resolver must be a function.");var e=d();try{n(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}return e.promise}function v(n){return p(function(e,t){for(var r=0,i=n.length;i>r;r++)l(n[r]).then(e,t)})}function h(n,e,t){void 0===e&&(e=function(n){return L(new Error("Promise does not support operation: "+n))}),void 0===t&&(t=function(){return{state:"unknown"}});var r=nn(h.prototype);if(r.promiseDispatch=function(t,i,u){var o;try{o=n[i]?n[i].apply(r,u):e.call(r,i,u)}catch(c){o=L(c)}t&&t(o)},r.inspect=t,t){var i=t();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var n=t();return"pending"===n.state||"rejected"===n.state?r:n.value}}return r}function m(n,e,t,r){return l(n).then(e,t,r)}function y(n){if(g(n)){var e=n.inspect();if("fulfilled"===e.state)return e.value}return n}function g(n){return n instanceof h}function x(n){return t(n)&&"function"==typeof n.then}function k(n){return g(n)&&"pending"===n.inspect().state}function b(n){return!g(n)||"fulfilled"===n.inspect().state}function j(n){return g(n)&&"rejected"===n.inspect().state}function w(){on.length=0,cn.length=0,sn||(sn=!0)}function A(n,t){sn&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){-1!==W(cn,n)&&(e.emit("unhandledRejection",t,n),an.push(n))}),cn.push(n),t&&"undefined"!=typeof t.stack?on.push(t.stack):on.push("(no stack) "+t))}function O(n){if(sn){var t=W(cn,n);-1!==t&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){var r=W(an,n);-1!==r&&(e.emit("rejectionHandled",on[t],n),an.splice(r,1))}),cn.splice(t,1),on.splice(t,1))}}function L(n){var e=h({when:function(e){return e&&O(this),e?e(n):this}},function(){return this},function(){return{state:"rejected",reason:n}});return A(e,n),e}function S(n){return h({when:function(){return n},get:function(e){return n[e]},set:function(e,t){n[e]=t},"delete":function(e){delete n[e]},post:function(e,t){return null===e||void 0===e?n.apply(void 0,t):n[e].apply(n,t)},apply:function(e,t){return n.apply(e,t)},keys:function(){return tn(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function R(n){var e=d();return l.nextTick(function(){try{n.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise}function q(n){return h({isDef:function(){}},function(e,t){return P(n,e,t)},function(){return l(n).inspect()})}function E(n,e,t){return l(n).spread(e,t)}function $(n){return function(){function e(n,e){var o;if("undefined"==typeof StopIteration){try{o=t[n](e)}catch(c){return L(c)}return o.done?l(o.value):m(o.value,i,u)}try{o=t[n](e)}catch(c){return r(c)?l(c.value):L(c)}return m(o,i,u)}var t=n.apply(this,arguments),i=e.bind(e,"next"),u=e.bind(e,"throw");return i()}}function I(n){l.done(l.async(n)())}function T(n){throw new _(n)}function C(n){return function(){return E([this,N(arguments)],function(e,t){return n.apply(e,t)})}}function P(n,e,t){return l(n).dispatch(e,t)}function N(n){return m(n,function(n){var e=0,t=d();return X(n,function(r,i,u){var o;g(i)&&"fulfilled"===(o=i.inspect()).state?n[u]=o.value:(++e,m(i,function(r){n[u]=r,0===--e&&t.resolve(n)},t.reject,function(n){t.notify({index:u,value:n})}))},void 0),0===e&&t.resolve(n),t.promise})}function z(n){if(0===n.length)return l.resolve();var e=l.defer(),t=0;return X(n,function(r,i,u){function o(n){e.resolve(n)}function c(){t--,0===t&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function a(n){e.notify({index:u,value:n})}var s=n[u];t++,m(s,o,c,a)},void 0),e.promise}function F(n){return m(n,function(n){return n=Z(n,l),m(N(Z(n,function(n){return m(n,Q,Q)})),function(){return n})})}function U(n){return l(n).allSettled()}function M(n,e){return l(n).then(void 0,void 0,e)}function B(n,e){return l(n).nodeify(e)}var K=!1;try{throw new Error}catch(D){K=!!D.stack}var V,_,J=s(),Q=function(){},Y=function(){function n(){for(var n,e;r.next;)r=r.next,n=r.task,r.task=void 0,e=r.domain,e&&(r.domain=void 0,e.enter()),t(n,e);for(;a.length;)n=a.pop(),t(n);u=!1}function t(e,t){try{e()}catch(r){if(c)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),r;setTimeout(function(){throw r},0)}t&&t.exit()}var r={task:void 0,next:null},i=r,u=!1,o=void 0,c=!1,a=[];if(Y=function(n){i=i.next={task:n,domain:c&&e.domain,next:null},u||(u=!0,o())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)c=!0,o=function(){e.nextTick(n)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){o=f,s.port1.onmessage=n,n()};var f=function(){s.port2.postMessage(0)};o=function(){setTimeout(n,0),f()}}else o=function(){setTimeout(n,0)};return Y.runAfter=function(n){a.push(n),u||(u=!0,o())},Y}(),G=Function.call,H=n(Array.prototype.slice),X=n(Array.prototype.reduce||function(n,e){var t=0,r=this.length;if(1===arguments.length)for(;;){if(t in this){e=this[t++];break}if(++t>=r)throw new TypeError}for(;r>t;t++)t in this&&(e=n(e,this[t],t));return e}),W=n(Array.prototype.indexOf||function(n){for(var e=0;e<this.length;e++)if(this[e]===n)return e;return-1}),Z=n(Array.prototype.map||function(n,e){var t=this,r=[];return X(t,function(i,u,o){r.push(n.call(e,u,o,t))},void 0),r}),nn=Object.create||function(n){function e(){}return e.prototype=n,new e},en=n(Object.prototype.hasOwnProperty),tn=Object.keys||function(n){var e=[];for(var t in n)en(n,t)&&e.push(t);return e},rn=n(Object.prototype.toString);_="undefined"!=typeof ReturnValue?ReturnValue:function(n){this.value=n};var un="From previous event:";l.resolve=l,l.nextTick=Y,l.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=d,d.prototype.makeNodeResolver=function(){var n=this;return function(e,t){e?n.reject(e):arguments.length>2?n.resolve(H(arguments,1)):n.resolve(t)}},l.Promise=p,l.promise=p,p.race=v,p.all=N,p.reject=L,p.resolve=l,l.passByCopy=function(n){return n},h.prototype.passByCopy=function(){return this},l.join=function(n,e){return l(n).join(e)},h.prototype.join=function(n){return l([this,n]).spread(function(n,e){if(n===e)return n;throw new Error("Can't join: not the same: "+n+" "+e)})},l.race=v,h.prototype.race=function(){return this.then(l.race)},l.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(n,e,t){function r(e){try{return"function"==typeof n?n(e):e}catch(t){return L(t)}}function u(n){if("function"==typeof e){i(n,c);try{return e(n)}catch(t){return L(t)}}return L(n)}function o(n){return"function"==typeof t?t(n):n}var c=this,a=d(),s=!1;return l.nextTick(function(){c.promiseDispatch(function(n){s||(s=!0,a.resolve(r(n)))},"when",[function(n){s||(s=!0,a.resolve(u(n)))}])}),c.promiseDispatch(void 0,"when",[void 0,function(n){var e,t=!1;try{e=o(n)}catch(r){if(t=!0,!l.onerror)throw r;l.onerror(r)}t||a.notify(e)}]),a.promise},l.tap=function(n,e){return l(n).tap(e)},h.prototype.tap=function(n){return n=l(n),this.then(function(e){return n.fcall(e).thenResolve(e)})},l.when=m,h.prototype.thenResolve=function(n){return this.then(function(){return n})},l.thenResolve=function(n,e){return l(n).thenResolve(e)},h.prototype.thenReject=function(n){return this.then(function(){throw n})},l.thenReject=function(n,e){return l(n).thenReject(e)},l.nearer=y,l.isPromise=g,l.isPromiseAlike=x,l.isPending=k,h.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=b,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=j,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var on=[],cn=[],an=[],sn=!0;l.resetUnhandledRejections=w,l.getUnhandledReasons=function(){return on.slice()},l.stopUnhandledRejectionTracking=function(){w(),sn=!1},w(),l.reject=L,l.fulfill=S,l.master=q,l.spread=E,h.prototype.spread=function(n,e){return this.all().then(function(e){return n.apply(void 0,e)},e)},l.async=$,l.spawn=I,l["return"]=T,l.promised=C,l.dispatch=P,h.prototype.dispatch=function(n,e){var t=this,r=d();return l.nextTick(function(){t.promiseDispatch(r.resolve,n,e)}),r.promise},l.get=function(n,e){return l(n).dispatch("get",[e])},h.prototype.get=function(n){return this.dispatch("get",[n])},l.set=function(n,e,t){return l(n).dispatch("set",[e,t])},h.prototype.set=function(n,e){return this.dispatch("set",[n,e])},l.del=l["delete"]=function(n,e){return l(n).dispatch("delete",[e])},h.prototype.del=h.prototype["delete"]=function(n){return this.dispatch("delete",[n])},l.mapply=l.post=function(n,e,t){return l(n).dispatch("post",[e,t])},h.prototype.mapply=h.prototype.post=function(n,e){return this.dispatch("post",[n,e])},l.send=l.mcall=l.invoke=function(n,e){return l(n).dispatch("post",[e,H(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(n){return this.dispatch("post",[n,H(arguments,1)])},l.fapply=function(n,e){return l(n).dispatch("apply",[void 0,e])},h.prototype.fapply=function(n){return this.dispatch("apply",[void 0,n])},l["try"]=l.fcall=function(n){return l(n).dispatch("apply",[void 0,H(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,H(arguments)])},l.fbind=function(n){var e=l(n),t=H(arguments,1);return function(){return e.dispatch("apply",[this,t.concat(H(arguments))])}},h.prototype.fbind=function(){var n=this,e=H(arguments);return function(){return n.dispatch("apply",[this,e.concat(H(arguments))])}},l.keys=function(n){return l(n).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},l.all=N,h.prototype.all=function(){return N(this)},l.any=z,h.prototype.any=function(){return z(this)},l.allResolved=f(F,"allResolved","allSettled"),h.prototype.allResolved=function(){return F(this)},l.allSettled=U,h.prototype.allSettled=function(){return this.then(function(n){return N(Z(n,function(n){function e(){return n.inspect()}return n=l(n),n.then(e,e)}))})},l.fail=l["catch"]=function(n,e){return l(n).then(void 0,e)},h.prototype.fail=h.prototype["catch"]=function(n){return this.then(void 0,n)},l.progress=M,h.prototype.progress=function(n){return this.then(void 0,void 0,n)},l.fin=l["finally"]=function(n,e){return l(n)["finally"](e)},h.prototype.fin=h.prototype["finally"]=function(n){return n=l(n),this.then(function(e){return n.fcall().then(function(){return e})},function(e){return n.fcall().then(function(){throw e})})},l.done=function(n,e,t,r){return l(n).done(e,t,r)},h.prototype.done=function(n,t,r){var u=function(n){l.nextTick(function(){if(i(n,o),!l.onerror)throw n;l.onerror(n)})},o=n||t||r?this.then(n,t,r):this;"object"==typeof e&&e&&e.domain&&(u=e.domain.bind(u)),o.then(void 0,u)},l.timeout=function(n,e,t){return l(n).timeout(e,t)},h.prototype.timeout=function(n,e){var t=d(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+n+" ms"),e.code="ETIMEDOUT"),t.reject(e)},n);return this.then(function(n){clearTimeout(r),t.resolve(n)},function(n){clearTimeout(r),t.reject(n)},t.notify),t.promise},l.delay=function(n,e){return void 0===e&&(e=n,n=void 0),l(n).delay(e)},h.prototype.delay=function(n){return this.then(function(e){var t=d();return setTimeout(function(){t.resolve(e)},n),t.promise})},l.nfapply=function(n,e){return l(n).nfapply(e)},h.prototype.nfapply=function(n){var e=d(),t=H(n);return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},l.nfcall=function(n){var e=H(arguments,1);return l(n).nfapply(e)},h.prototype.nfcall=function(){var n=H(arguments),e=d();return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},l.nfbind=l.denodeify=function(n){var e=H(arguments,1);return function(){var t=e.concat(H(arguments)),r=d();return t.push(r.makeNodeResolver()),l(n).fapply(t).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var n=H(arguments);return n.unshift(this),l.denodeify.apply(void 0,n)},l.nbind=function(n,e){var t=H(arguments,2);return function(){function r(){return n.apply(e,arguments)}var i=t.concat(H(arguments)),u=d();return i.push(u.makeNodeResolver()),l(r).fapply(i).fail(u.reject),u.promise}},h.prototype.nbind=function(){var n=H(arguments,0);return n.unshift(this),l.nbind.apply(void 0,n)},l.nmapply=l.npost=function(n,e,t){return l(n).npost(e,t)},h.prototype.nmapply=h.prototype.npost=function(n,e){var t=H(e||[]),r=d();return t.push(r.makeNodeResolver()),this.dispatch("post",[n,t]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(n,e){var t=H(arguments,2),r=d();return t.push(r.makeNodeResolver()),l(n).dispatch("post",[e,t]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(n){var e=H(arguments,1),t=d();return e.push(t.makeNodeResolver()),this.dispatch("post",[n,e]).fail(t.reject),t.promise},l.nodeify=B,h.prototype.nodeify=function(n){return n?void this.then(function(e){l.nextTick(function(){n(null,e)})},function(e){l.nextTick(function(){n(e)})}):this},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var fn=s();return l})}).call(this,e("_process"))},{_process:3}],5:[function(n,e,t){function r(n,e){function t(n){if("string"==typeof n){var e=n,t=function(n){return n[e]};return t}return n}function u(n){if("string"==typeof n){var e=n,t=function(n){return+n[e]};return t}return n}n.fromObject=function(t){return arguments.length?(_assign(e,t),
n):e},n.toObject=function(){return e},n.count=function(t){return arguments.length?(e.count=t,n):e.count},n.sum=function(t){return arguments.length?(t=u(t),e.sum=t,n):e.sum},n.avg=function(t){return arguments.length?(t=u(t),"function"==typeof t?(e.sum&&console.warn("SUM aggregation is being overwritten by AVG aggregation"),e.sum=t,e.avg=!0,e.count=!0):e.avg=t,n):e.avg},n.exception=function(r){return arguments.length?(r=t(r),e.exceptionAccessor=r,n):e.exceptionAccessor},n.filter=function(t){return arguments.length?(e.filter=t,n):e.filter},n.valueList=function(r){return arguments.length?(r=t(r),e.valueList=r,n):e.valueList},n.median=function(t){return arguments.length?(t=u(t),"function"==typeof t&&(e.valueList&&console.warn("VALUELIST accessor is being overwritten by median aggregation"),e.valueList=t),e.median=t,n):e.median},n.min=function(t){return arguments.length?(t=u(t),"function"==typeof t&&(e.valueList&&console.warn("VALUELIST accessor is being overwritten by median aggregation"),e.valueList=t),e.min=t,n):e.min},n.max=function(t){return arguments.length?(t=u(t),"function"==typeof t&&(e.valueList&&console.warn("VALUELIST accessor is being overwritten by median aggregation"),e.valueList=t),e.max=t,n):e.max},n.exceptionCount=function(r){return arguments.length?(r=t(r),"function"==typeof r?(e.sum&&console.warn("EXCEPTION accessor is being overwritten by exception count aggregation"),e.exceptionAccessor=r,e.exceptionCount=!0):e.exceptionCount=r,n):e.exceptionCount},n.exceptionSum=function(t){return arguments.length?(t=u(t),e.exceptionSum=t,n):e.exceptionSum},n.histogramValue=function(t){return arguments.length?(t=u(t),e.histogramValue=t,n):e.histogramValue},n.histogramBins=function(t){return arguments.length?(e.histogramThresholds=t,n):e.histogramThresholds},n.std=function(t){return arguments.length?(t=u(t),"function"==typeof t?(e.sumOfSquares=t,e.sum=t,e.count=!0,e.std=!0):e.std=t,n):e.std},n.sumOfSq=function(t){return arguments.length?(t=u(t),e.sumOfSquares=t,n):e.sumOfSquares},n.value=function(n,t){return arguments.length&&"string"==typeof n?(e.values||(e.values={}),e.values[n]={},e.values[n].parameters=i(),r(e.values[n],e.values[n].parameters),t&&(e.values[n].accessor=t),e.values[n]):void console.error("'value' requires a string argument.")},n.nest=function(r){return arguments.length?(r.map(t),e.nestKeys=r,n):e.nestKeys},n.alias=function(t){return arguments.length?(e.aliasKeys=t,n):e.aliasKeys},n.aliasProp=function(t){return arguments.length?(e.aliasPropKeys=t,n):e.aliasPropKeys},n.groupAll=function(t){return arguments.length?(e.groupAll=t,n):e.groupAll},n.dataList=function(t){return arguments.length?(e.dataList=t,n):e.dataList}}var i=n("./parameters.js");_assign=function(n){if(null==n)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(n),t=1;t<arguments.length;++t){var r=arguments[t];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e};var u={build:r};e.exports=u},{"./parameters.js":21}],6:[function(n,e,t){var r={initial:function(n,e,t){return function(r){function i(n){return function(){return t[n](e(r))}}n&&(r=n(r));for(var u in t)e(r)[u]=i(u);return r}}};e.exports=r},{}],7:[function(n,e,t){var r={add:function(n,e,t){return function(r,i,u){e&&e(r,i,u);for(var o in n)t(r)[o]=n[o](t(r),i);return r}}};e.exports=r},{}],8:[function(n,e,t){var r={add:function(n,e,t){return function(n,r,i){return e&&e(n,r,i),t(n).count>0?t(n).avg=t(n).sum/t(n).count:t(n).avg=0,n}},remove:function(n,e,t){return function(n,r,i){return e&&e(n,r,i),t(n).count>0?t(n).avg=t(n).sum/t(n).count:t(n).avg=0,n}},initial:function(n,e){return function(t){return t=n(t),e(t).avg=0,t}}};e.exports=r},{}],9:[function(n,e,t){function r(n,e,t){t||(t=function(n){return n});var j={reduceAdd:e.reduceAdd,reduceRemove:e.reduceRemove,reduceInitial:e.reduceInitial};(n.count||n.std)&&(e.reduceAdd=u.add(e.reduceAdd,t),e.reduceRemove=u.remove(e.reduceRemove,t),e.reduceInitial=u.initial(e.reduceInitial,t)),n.sum&&(e.reduceAdd=o.add(n.sum,e.reduceAdd,t),e.reduceRemove=o.remove(n.sum,e.reduceRemove,t),e.reduceInitial=o.initial(e.reduceInitial,t)),n.avg&&(n.count&&n.sum?(e.reduceAdd=c.add(n.sum,e.reduceAdd,t),e.reduceRemove=c.remove(n.sum,e.reduceRemove,t),e.reduceInitial=c.initial(e.reduceInitial,t)):console.error("You must set .count(true) and define a .sum(accessor) to use .avg(true).")),n.exceptionCount&&(n.exceptionAccessor?(e.reduceAdd=p.add(n.exceptionAccessor,e.reduceAdd,t),e.reduceRemove=p.remove(n.exceptionAccessor,e.reduceRemove,t),e.reduceInitial=p.initial(e.reduceInitial,t)):console.error("You must define an .exception(accessor) to use .exceptionCount(true).")),n.exceptionSum&&(n.exceptionAccessor?(e.reduceAdd=v.add(n.exceptionAccessor,n.exceptionSum,e.reduceAdd,t),e.reduceRemove=v.remove(n.exceptionAccessor,n.exceptionSum,e.reduceRemove,t),e.reduceInitial=v.initial(e.reduceInitial,t)):console.error("You must define an .exception(accessor) to use .exceptionSum(accessor).")),(n.valueList||n.median||n.min||n.max)&&(e.reduceAdd=d.add(n.valueList,e.reduceAdd,t),e.reduceRemove=d.remove(n.valueList,e.reduceRemove,t),e.reduceInitial=d.initial(e.reduceInitial,t)),n.dataList&&(e.reduceAdd=b.add(n.dataList,e.reduceAdd,t),e.reduceRemove=b.remove(n.dataList,e.reduceRemove,t),e.reduceInitial=b.initial(e.reduceInitial,t)),n.median&&(e.reduceAdd=a.add(e.reduceAdd,t),e.reduceRemove=a.remove(e.reduceRemove,t),e.reduceInitial=a.initial(e.reduceInitial,t)),n.min&&(e.reduceAdd=s.add(e.reduceAdd,t),e.reduceRemove=s.remove(e.reduceRemove,t),e.reduceInitial=s.initial(e.reduceInitial,t)),n.max&&(e.reduceAdd=f.add(e.reduceAdd,t),e.reduceRemove=f.remove(e.reduceRemove,t),e.reduceInitial=f.initial(e.reduceInitial,t)),n.exceptionAccessor&&(e.reduceAdd=l.add(n.exceptionAccessor,e.reduceAdd,t),e.reduceRemove=l.remove(n.exceptionAccessor,e.reduceRemove,t),e.reduceInitial=l.initial(e.reduceInitial,t)),n.histogramValue&&n.histogramThresholds&&(e.reduceAdd=h.add(n.histogramValue,e.reduceAdd,t),e.reduceRemove=h.remove(n.histogramValue,e.reduceRemove,t),e.reduceInitial=h.initial(n.histogramThresholds,e.reduceInitial,t)),n.sumOfSquares&&(e.reduceAdd=m.add(n.sumOfSquares,e.reduceAdd,t),e.reduceRemove=m.remove(n.sumOfSquares,e.reduceRemove,t),e.reduceInitial=m.initial(e.reduceInitial,t)),n.std&&(n.sumOfSquares&&n.sum?(e.reduceAdd=y.add(e.reduceAdd,t),e.reduceRemove=y.remove(e.reduceRemove,t),e.reduceInitial=y.initial(e.reduceInitial,t)):console.error("You must set .sumOfSq(accessor) and define a .sum(accessor) to use .std(true). Or use .std(accessor).")),n.nestKeys&&(e.reduceAdd=g.add(n.nestKeys,e.reduceAdd,t),e.reduceRemove=g.remove(n.nestKeys,e.reduceRemove,t),e.reduceInitial=g.initial(e.reduceInitial,t)),n.aliasKeys&&(e.reduceInitial=x.initial(e.reduceInitial,t,n.aliasKeys)),n.aliasPropKeys&&(e.reduceAdd=k.add(n.aliasPropKeys,e.reduceAdd,t),e.reduceRemove=k.add(n.aliasPropKeys,e.reduceRemove,t)),n.filter&&(e.reduceAdd=i.add(n.filter,e.reduceAdd,j.reduceAdd,t),e.reduceRemove=i.remove(n.filter,e.reduceRemove,j.reduceRemove,t)),n.values&&Object.getOwnPropertyNames(n.values).forEach(function(i){var u=function(n){return function(e){return e=n(e),t(e)[i]={},e}};e.reduceInitial=u(e.reduceInitial),r(n.values[i].parameters,e,function(n){return n[i]})})}var i=n("./filter.js"),u=n("./count.js"),o=n("./sum.js"),c=n("./avg.js"),a=n("./median.js"),s=n("./min.js"),f=n("./max.js"),l=n("./value-count.js"),d=n("./value-list.js"),p=n("./exception-count.js"),v=n("./exception-sum.js"),h=n("./histogram.js"),m=n("./sum-of-squares.js"),y=n("./std.js"),g=n("./nest.js"),x=n("./alias.js"),k=n("./aliasProp.js"),b=n("./data-list.js"),j={build:r};e.exports=j},{"./alias.js":6,"./aliasProp.js":7,"./avg.js":8,"./count.js":11,"./data-list.js":12,"./exception-count.js":13,"./exception-sum.js":14,"./filter.js":15,"./histogram.js":16,"./max.js":17,"./median.js":18,"./min.js":19,"./nest.js":20,"./std.js":26,"./sum-of-squares.js":27,"./sum.js":28,"./value-count.js":29,"./value-list.js":30}],10:[function(n,e,t){var r=function(n){return function(e){return e[n]}};_grouper=function(n,e){return n||(n=function(n){return n}),function(t,r){e&&e(t,r);var i=n(t),u=n(r);return"undefined"!=typeof u.count&&(i.count+=u.count),"undefined"!=typeof u.sum&&(i.sum+=u.sum),"undefined"!=typeof u.avg&&(i.avg=i.sum/i.count),t}},reductio_cap=function(n,e,t){var i=(e.reduceInitial(),t.values?Object.keys(t.values):[]),u=_grouper();if(i.length)for(var o=0;o<i.length;++o)u=_grouper(r(i[o]),u);return function(t,r){if(!arguments.length)return n();if(t===1/0||!t)return n();var i=n(),o=t-1;if(i.length<=t)return i;var c=i.slice(0,o),a={key:r||"Others"};a.value=e.reduceInitial();for(var s=o;s<i.length;++s)u(a.value,i[s].value);return c.push(a),c}},e.exports=reductio_cap},{}],11:[function(n,e,t){var r={add:function(n,e){return function(t,r,i){return n&&n(t,r,i),e(t).count++,t}},remove:function(n,e){return function(t,r,i){return n&&n(t,r,i),e(t).count--,t}},initial:function(n,e){return function(t){return n&&(t=n(t)),e(t).count=0,t}}};e.exports=r},{}],12:[function(n,e,t){var r={add:function(n,e,t){return function(n,r,i){return e&&e(n,r,i),t(n).dataList.push(r),n}},remove:function(n,e,t){return function(n,r,i){return e&&e(n,r,i),t(n).dataList.splice(t(n).dataList.indexOf(r),1),n}},initial:function(n,e){return function(t){return n&&(t=n(t)),e(t).dataList=[],t}}};e.exports=r},{}],13:[function(n,e,t){var r={add:function(n,e,t){var r,i;return function(u,o,c){return e&&e(u,o,c),r=t(u).bisect(t(u).values,n(o),0,t(u).values.length),i=t(u).values[r],i&&i[0]===n(o)&&0!==i[1]||t(u).exceptionCount++,u}},remove:function(n,e,t){var r,i;return function(u,o,c){return e&&e(u,o,c),r=t(u).bisect(t(u).values,n(o),0,t(u).values.length),i=t(u).values[r],i&&i[0]===n(o)&&1===i[1]&&t(u).exceptionCount--,u}},initial:function(n,e){return function(t){return t=n(t),e(t).exceptionCount=0,t}}};e.exports=r},{}],14:[function(n,e,t){var r={add:function(n,e,t,r){var i,u;return function(o,c,a){return t&&t(o,c,a),i=r(o).bisect(r(o).values,n(c),0,r(o).values.length),u=r(o).values[i],u&&u[0]===n(c)&&0!==u[1]||(r(o).exceptionSum=r(o).exceptionSum+e(c)),o}},remove:function(n,e,t,r){var i,u;return function(o,c,a){return t&&t(o,c,a),i=r(o).bisect(r(o).values,n(c),0,r(o).values.length),u=r(o).values[i],u&&u[0]===n(c)&&1===u[1]&&(r(o).exceptionSum=r(o).exceptionSum-e(c)),o}},initial:function(n,e){return function(t){return t=n(t),e(t).exceptionSum=0,t}}};e.exports=r},{}],15:[function(n,e,t){var r={add:function(n,e,t){return function(r,i,u){return n(i,u)?e&&e(r,i,u):t&&t(r,i,u),r}},remove:function(n,e,t){return function(r,i,u){return n(i,u)?e&&e(r,i,u):t&&t(r,i,u),r}}};e.exports=r},{}],16:[function(n,e,t){var r=n("crossfilter"),i={add:function(n,e,t){var i,u=r.bisect.by(function(n){return n}).left,o=r.bisect.by(function(n){return n.x}).right;return function(r,c,a){return e&&e(r,c,a),i=t(r).histogram[o(t(r).histogram,n(c),0,t(r).histogram.length)-1],i.y++,i.splice(u(i,n(c),0,i.length),0,n(c)),r}},remove:function(n,e,t){var i,u=r.bisect.by(function(n){return n}).left,o=r.bisect.by(function(n){return n.x}).right;return function(r,c,a){return e&&e(r,c,a),i=t(r).histogram[o(t(r).histogram,n(c),0,t(r).histogram.length)-1],i.y--,i.splice(u(i,n(c),0,i.length),1),r}},initial:function(n,e,t){return function(r){r=e(r),t(r).histogram=[];for(var i=[],u=1;u<n.length;u++)i=[],i.x=n[u-1],i.dx=n[u]-n[u-1],i.y=0,t(r).histogram.push(i);return r}}};e.exports=i},{crossfilter:2}],17:[function(n,e,t){var r={add:function(n,e){return function(t,r,i){return n&&n(t,r,i),e(t).max=e(t).valueList[e(t).valueList.length-1],t}},remove:function(n,e){return function(t,r,i){return n&&n(t,r,i),0===e(t).valueList.length?(e(t).max=void 0,t):(e(t).max=e(t).valueList[e(t).valueList.length-1],t)}},initial:function(n,e){return function(t){return t=n(t),e(t).max=void 0,t}}};e.exports=r},{}],18:[function(n,e,t){var r={add:function(n,e){var t;return function(r,i,u){return n&&n(r,i,u),t=Math.floor(e(r).valueList.length/2),e(r).valueList.length%2?e(r).median=e(r).valueList[t]:e(r).median=(e(r).valueList[t-1]+e(r).valueList[t])/2,r}},remove:function(n,e){var t;return function(r,i,u){return n&&n(r,i,u),t=Math.floor(e(r).valueList.length/2),0===e(r).valueList.length?(e(r).median=void 0,r):(1===e(r).valueList.length||e(r).valueList.length%2?e(r).median=e(r).valueList[t]:e(r).median=(e(r).valueList[t-1]+e(r).valueList[t])/2,r)}},initial:function(n,e){return function(t){return t=n(t),e(t).median=void 0,t}}};e.exports=r},{}],19:[function(n,e,t){var r={add:function(n,e){return function(t,r,i){return n&&n(t,r,i),e(t).min=e(t).valueList[0],t}},remove:function(n,e){return function(t,r,i){return n&&n(t,r,i),0===e(t).valueList.length?(e(t).min=void 0,t):(e(t).min=e(t).valueList[0],t)}},initial:function(n,e){return function(t){return t=n(t),e(t).min=void 0,t}}};e.exports=r},{}],20:[function(n,e,t){var r=(n("crossfilter"),{add:function(n,e,t){var r,i;return function(u,o,c){return e&&e(u,o,c),r=t(u).nest,n.forEach(function(n){i=r.filter(function(e){return e.key===n(o)})[0],i?r=i.values:(i=[],r.push({key:n(o),values:i}),r=i)}),r.push(o),u}},remove:function(n,e,t){var r;return function(i,u,o){return e&&e(i,u,o),r=t(i).nest,n.forEach(function(n){r=r.filter(function(e){return e.key===n(u)})[0].values}),r.splice(r.indexOf(u),1),i}},initial:function(n,e){return function(t){return t=n(t),e(t).nest=[],t}}});e.exports=r},{crossfilter:2}],21:[function(n,e,t){var r=function(){return{order:!1,avg:!1,count:!1,sum:!1,exceptionAccessor:!1,exceptionCount:!1,exceptionSum:!1,filter:!1,valueList:!1,median:!1,histogramValue:!1,min:!1,max:!1,histogramThresholds:!1,std:!1,sumOfSquares:!1,values:!1,nestKeys:!1,aliasKeys:!1,aliasPropKeys:!1,groupAll:!1,dataList:!1}};e.exports=r},{}],22:[function(n,e,t){function r(n){return function(e,t,r){e.post=function(){var i=function(){return i.all()};i.all=function(){return e.all()};var u=n.postprocessors;return Object.keys(u).forEach(function(n){i[n]=function(){var e=i.all,o=[].slice.call(arguments);return i.all=function(){return u[n](e,r,t).apply(null,o)},i}}),i}}}e.exports=r},{}],23:[function(n,e,t){e.exports=function(e){e.postprocessors={},e.registerPostProcessor=function(n,t){e.postprocessors[n]=t},e.registerPostProcessor("cap",n("./cap")),e.registerPostProcessor("sortBy",n("./sortBy"))}},{"./cap":10,"./sortBy":25}],24:[function(n,e,t){function r(){function n(n){if(t={reduceAdd:function(n){return n},reduceRemove:function(n){return n},reduceInitial:function(){return{}}},i.build(e,t),e.groupAll)if(n.top)console.warn("'groupAll' is defined but attempting to run on a standard dimension.group(). Must run on dimension.groupAll().");else{var r,u,o,s,f,l=a.bisect.by(function(n){return n.key}).left;n.reduce(function(n,i,c){for(o=e.groupAll(i),s=o.length,u=0;s>u;u++)f=o[u],r=l(n,f,0,n.length),n[r]&&n[r].key===f||n.splice(r,0,{key:f,value:t.reduceInitial()}),t.reduceAdd(n[r].value,i,c);return n},function(n,i,c){for(o=e.groupAll(i),s=o.length,u=0;s>u;u++)r=l(n,o[u],0,n.length),t.reduceRemove(n[r].value,i,c);return n},function(){return[]}),n.all||(n.all=function(){return this.value()})}else n.reduce(t.reduceAdd,t.reduceRemove,t.reduceInitial);return c(n,e,t),n}var e=o(),t={};return u.build(n,e),n}var i=n("./build.js"),u=n("./accessors.js"),o=n("./parameters.js"),c=n("./postprocess"),a=n("crossfilter");n("./postprocessors")(r),c=c(r),e.exports=r},{"./accessors.js":5,"./build.js":9,"./parameters.js":21,"./postprocess":22,"./postprocessors":23,crossfilter:2}],25:[function(n,e,t){function r(n,e){return e>n?-1:n>e?1:n>=e?0:NaN}var i=function(n){if("function"==typeof n)return n;if(~n.indexOf(".")){var e=n.split(".");return function(n){return e.reduce(function(n,e){return n[e]},n)}}return function(e){return e[n]}},u=function(n,e){return function(t,r){return e(n(t),n(r))}};({}).toString;e.exports=function(n){return function(e,t){return 1===arguments.length&&(t=r),n().sort(u(i(e),t))}}},{}],26:[function(n,e,t){var r={add:function(n,e){return function(t,r,i){if(n&&n(t,r,i),e(t).count>0){e(t).std=0;var u=e(t).sumOfSq-e(t).sum*e(t).sum/e(t).count;u>0&&(e(t).std=Math.sqrt(u/(e(t).count-1)))}else e(t).std=0;return t}},remove:function(n,e){return function(t,r,i){if(n&&n(t,r,i),e(t).count>0){e(t).std=0;var u=e(t).sumOfSq-e(t).sum*e(t).sum/e(t).count;u>0&&(e(t).std=Math.sqrt(u/(e(t).count-1)))}else e(t).std=0;return t}},initial:function(n,e){return function(t){return t=n(t),e(t).std=0,t}}};e.exports=r},{}],27:[function(n,e,t){var r={add:function(n,e,t){return function(r,i,u){return e&&e(r,i,u),t(r).sumOfSq=t(r).sumOfSq+n(i)*n(i),r}},remove:function(n,e,t){return function(r,i,u){return e&&e(r,i,u),t(r).sumOfSq=t(r).sumOfSq-n(i)*n(i),r}},initial:function(n,e){return function(t){return t=n(t),e(t).sumOfSq=0,t}}};e.exports=r},{}],28:[function(n,e,t){var r={add:function(n,e,t){return function(r,i,u){return e&&e(r,i,u),t(r).sum=t(r).sum+n(i),r}},remove:function(n,e,t){return function(r,i,u){return e&&e(r,i,u),t(r).sum=t(r).sum-n(i),r}},initial:function(n,e){return function(t){return t=n(t),e(t).sum=0,t}}};e.exports=r},{}],29:[function(n,e,t){var r=n("crossfilter"),i={add:function(n,e,t){var r,i;return function(u,o,c){return e&&e(u,o,c),r=t(u).bisect(t(u).values,n(o),0,t(u).values.length),i=t(u).values[r],i&&i[0]===n(o)?i[1]++:t(u).values.splice(r,0,[n(o),1]),u}},remove:function(n,e,t){var r;return function(i,u,o){return e&&e(i,u,o),r=t(i).bisect(t(i).values,n(u),0,t(i).values.length),t(i).values[r][1]--,i}},initial:function(n,e){return function(t){return t=n(t),e(t).values=[],e(t).bisect=r.bisect.by(function(n){return n[0]}).left,t}}};e.exports=i},{crossfilter:2}],30:[function(n,e,t){var r=n("crossfilter"),i={add:function(n,e,t){var i,u=r.bisect.by(function(n){return n}).left;return function(r,o,c){return e&&e(r,o,c),i=u(t(r).valueList,n(o),0,t(r).valueList.length),t(r).valueList.splice(i,0,n(o)),r}},remove:function(n,e,t){var i,u=r.bisect.by(function(n){return n}).left;return function(r,o,c){return e&&e(r,o,c),i=u(t(r).valueList,n(o),0,t(r).valueList.length),t(r).valueList.splice(i,1),r}},initial:function(n,e){return function(t){return t=n(t),e(t).valueList=[],t}}};e.exports=i},{crossfilter:2}],31:[function(n,e,t){"use strict";function r(n){function e(){var e=i(n);return function(n){return e(n)}}if("string"==typeof n){if(!o(n))return n;n=a(n)}return"number"==typeof n?n:k.isObject(n)?e():void 0}function i(n){if(n=k.isObject(n)?u(n):n,k.isString(n))return o(n)?i(a(n)):function(e){return e[n]};if(k.isArray(n)){var e=k.map(n,i);return function(n){return e.map(function(e){return e(n)})}}if(n.key){if(b[n.key]){var t=i(n.value);return function(e){return b[n.key](t(e))}}console.error("Could not find aggregration method",n)}return[]}function u(n){var e,t=[];for(var r in n)if(n.hasOwnProperty(r)){e={key:r,value:n[r]};var i={};i[r]=n[r],t.push(i)}return t.length>1?t:e}function o(n){return["$","("].indexOf(n.charAt(0))>-1}function c(n){var e=[],t=n.indexOf("("),r=n.indexOf(")"),i=t>-1?n.substring(0,t):n;return b[i]?(t>-1&&r>-1&&r>t&&(e=n.substring(t+1,r).split(",")),{aggregator:b[i],params:e}):!1}function a(n){function e(n){return n=n.replace(" ",""),'"'+n.replace(t,function(n,t){return r.test(t)?"$"===t.charAt(0)?'":{"'+t.replace(r,function(n,t){return","===n?',"':e(n).trim()})+"}":':["'+t.replace(r,function(n,e){return'","'})+'"]':void 0})}var t=/\((.+)\)/g,r=/(?:\([^\(\)]*\))|(,)/g;return JSON.parse("{"+e(n)+"}")}function s(n){return n.reduce(function(n,e){return n+e},0)}function f(n){return n.reduce(function(n,e){return n+e},0)/n.length}function l(n){return Math.max.apply(null,n)}function d(n){return Math.min.apply(null,n)}function p(n){return n.length}function v(n){return n[0]}function h(n){return n[n.length-1]}function m(n,e){return n[e]}function y(n,e){return n[n.length-e]}function g(n,e){return n[Math.round(n.length*(e/100))]}function x(n,e){return n.map(function(n){return n[e]})}var k=n("./lodash"),b={$sum:s,$avg:f,$max:l,$min:d,$count:p,$first:v,$last:h,$get:m,$nth:m,$nthLast:y,$nthPct:g,$map:x};e.exports={makeValueAccessor:r,aggregators:b,extractKeyValOrArray:u,parseAggregatorParams:c}},{"./lodash":39}],32:[function(n,e,t){"use strict";var r=n("q"),i=n("./lodash");e.exports=function(n){return function(e){function t(e){var t=[];e.removeListeners&&(t=i.map(e.removeListeners,function(n){return r.resolve(n())}));var u=e.complex?JSON.stringify(e.key):e.key;return delete n.filters[u],e.dimension&&t.push(r.resolve(e.dimension.dispose())),r.all(t)}return e&&(e=i.isArray(e)?e:[e]),e?r.all(i.map(e,function(e){i.isObject(e)&&(e=e.key);var r=i.remove(n.columns,function(n){return i.isArray(e)?!i.xor(n.key,e).length:n.key===e?!n.dynamicReference:void 0})[0];r&&t(r)})).then(function(){return n}):r.all(i.map(n.columns,t)).then(function(){return n.columns=[],n})}}},{"./lodash":39,q:4}],33:[function(n,e,t){"use strict";var r=n("q"),i=n("./lodash");e.exports=function(e){function t(n){return i.isUndefined(n)&&(n=!0),i.isArray(n)||(n=[n]),r.all(i.map(n,c)).then(function(n){return e})}function u(n){return i.find(e.columns,function(e){return i.isArray(n)?!i.xor(e.key,n).length:e.key===n})}function o(n){return i.isNumber(n)?"number":i.isBoolean(n)?"bool":i.isArray(n)?"array":i.isObject(n)?"object":"string"}function c(n){var t=i.isObject(n)?n:{key:n},c=u(t.key);return c?(c=c,c.temporary=!1,c.dynamicReference&&(c.dynamicReference=!1),c.promise.then(function(){return e})):(t.queries=[],e.columns.push(t),t.promise=r["try"](function(){return r.resolve(e.cf.all())}).then(function(n){var e;if(i.isArray(t.key)){if(t.complex=!0,e=i.values(i.pick(n[0],t.key)),e.length!==t.key.length)throw new Error("Column key does not exist in data!",t.key)}else e=n[0][t.key];if(!t.complex&&t.key!==!0&&"undefined"==typeof e)throw new Error("Column key does not exist in data!",t.key);return t.type=t.key===!0?"all":t.complex?"complex":t.array?"array":o(e),a.make(t.key,t.type)}).then(function(n){function u(n){if(t.key===!0)return r.resolve();var e=a.makeAccessor(t.key);return t.values=t.values||[],r["try"](function(){return n&&n.added?r.resolve(n.added):r.resolve(t.dimension.bottom(1/0))}).then(function(n){if("complex"===t.type)var r=i.flatten(i.map(n,e));else if("array"===t.type)var r=i.flatten(i.map(n,e));else var r=i.map(n,e);t.values=i.uniq(t.values.concat(r))})}t.dimension=n,t.filterCount=0;var o=e.onDataChange(u);return t.removeListeners=[o],u()}),t.promise.then(function(){return e}))}var a=n("./dimension")(e),s=t;return s.find=u,s}},{"./dimension":36,"./lodash":39,q:4}],34:[function(n,e,t){"use strict";var r=n("q"),i=n("crossfilter2"),u=n("./lodash");e.exports=function(n){function e(n){return u.isArray(n)?r.resolve(i(n)):n&&"function"==typeof n.dimension?r.resolve(n):r.reject(new Error("No Crossfilter data or instance found!"))}function t(e){return n.options.generatedColumns?u.map(e,function(e,t){return u.forEach(n.options.generatedColumns,function(n,t){e[t]=n(e)}),e}):e}function o(e){return e=t(e),r["try"](function(){return r.resolve(n.cf.add(e))}).then(function(){return r.serial(u.map(n.dataListeners,function(n){return function(){return n({added:e})}}))}).then(function(){return n})}function c(){return r["try"](function(){return r.resolve(n.cf.remove())}).then(function(){return n})}return{build:e,generateColumns:t,add:o,remove:c}}},{"./lodash":39,crossfilter2:2,q:4}],35:[function(n,e,t){"use strict";var r=n("q");n("./lodash");e.exports=function(n){return function(){return n.clear().then(function(){return n.cf.dataListeners=[],n.cf.filterListeners=[],r.resolve(n.cf.remove())}).then(function(){return n})}}},{"./lodash":39,q:4}],36:[function(n,e,t){"use strict";var r=n("q"),i=n("./lodash");e.exports=function(n){function e(e,i){var u=t(e);return r.resolve(n.cf.dimension(u,"array"==i))}function t(n){var e;if(i.isArray(n)){var t=i.map(n,function(n){return"d['"+n+"']"});e=new Function("d","return "+JSON.stringify(t).replace(/\"/g,""))}else e=n===!0?function(n,e){return e}:function(e){return e[n]};return e}return{make:e,makeAccessor:t}}},{"./lodash":39,q:4}],37:[function(n,e,t){"use strict";function r(n,e){return n[e]}function i(n,e){e=e(n);for(var t=0;t<e.length;t++)if(!e[t])return!1;return!0}function u(n,e){e=e(n);for(var t=0;t<e.length;t++)if(e[t])return!0;return!1}function o(n,e){e=e(n);for(var t=0;t<e.length;t++)if(e[t])return!1;return!0}function c(n,e){return n===e()}function a(n,e){return n>e()}function s(n,e){return n>=e()}function f(n,e){return n<e()}function l(n,e){return n<=e()}function d(n,e){return n!==e()}function p(n,e){return typeof n===e()}function v(n,e){return n.indexOf(e())>-1}function h(n,e){return-1===n.indexOf(e())}function m(n,e){return e().indexOf(n)>-1}function y(n,e){return-1===e().indexOf(n)}function g(n,e){return n.length===e()}e.exports={$field:r,$and:i,$or:u,$not:o,$eq:c,$gt:a,$gte:s,$lt:f,$lte:l,$ne:d,$type:p,$in:v,$nin:h,$contains:m,$excludes:y,$size:g}},{}],38:[function(n,e,t){"use strict";var r=n("q"),i=n("./lodash"),u=n("./expressions"),o=n("./aggregation");e.exports=function(n){function e(e,t,u,o){var s=n.column.find(e);return r["try"](function(){return s?s:n.column({key:e,temporary:!0}).then(function(){return n.column.find(e)})}).then(function(e){var r=i.clone(n.filters,!0),s=e.complex?JSON.stringify(e.key):e.key;return r[s]=c(t,u,o),a(r)})}function t(){return a({})}function c(n,e,t){return i.isUndefined(n)?!1:i.isFunction(n)?{value:n,"function":n,replace:!0,type:"function"}:i.isObject(n)?{value:n,"function":d(n),replace:!0,type:"function"}:i.isArray(n)?{value:n,replace:e||t,type:e?"range":"inclusive"}:{value:n,replace:t,type:"exact"}}function a(e){var t=i.map(e,function(t,u){var o=n.filters[u];if(t.replace&&o&&i.isEqual(t,o))return r.resolve();var c;return c="["===u.charAt(0)?n.column.find(JSON.parse(u)):n.column.find(u),t&&o&&!t.replace&&(e[u]=t=s(t,o)),t?"exact"===t.type?r.resolve(c.dimension.filterExact(t.value)):"range"===t.type?r.resolve(c.dimension.filterRange(t.value)):"inclusive"===t.type?r.resolve(c.dimension.filterFunction(function(n){return t.value.indexOf(n)>-1})):"function"===t.type?r.resolve(c.dimension.filterFunction(t["function"])):r.resolve(c.dimension.filterAll()):r.resolve(c.dimension.filterAll())});return r.all(t).then(function(){n.filters=e;var t=[];return i.forEach(n.filters,function(e,r){e||(t.push({key:r,val:e}),delete n.filters[r])}),r.all(i.map(t,function(e){var t=n.column.find("["===e.key.charAt(0)?JSON.parse(e.key):e.key);return t.temporary&&!t.dynamicReference?n.clear(t.key):void 0}))}).then(function(){return r.all(i.map(n.filterListeners,function(n){return n()}))}).then(function(){return n})}function s(n,e){if("exact"===n.type&&"inclusive"===e.type)n.value=i.xor([n.value],e.value);else if("inclusive"===n.type&&"exact"===e.type)n.value=i.xor(n.value,[e.value]);else if("inclusive"===n.type&&"inclusive"===e.type)n.value=i.xor(n.value,e.value);else if("exact"===n.type&&"exact"===e.type){if(n.value===e.value)return!1;n.value=[n.value,e.value]}return n.value.length?1===n.value.length?(n.type="exact",n.value=n.value[0]):n.type="inclusive":n=!1,n}function f(n){function e(n){i.forEach(n,function(n,r){var u=l(n,r);u&&t.push(u),i.isString(n)&&(u=l(null,n),u&&t.push(u)),i.isObject(n)&&e(n)})}var t=[];return e(n.filter),t}function l(n,e){return"$data"===e?!0:e&&"$column"===e?i.isString(n)?n:(console.warn('The value for filter "$column" must be a valid column key',n),!1):void 0}function d(e,t){var r;if(i.isString(e)){var c=l(null,e);if(c){var a=n.cf.all();return function(n){return a}}}return i.isString(e)||i.isNumber(e)||i.isBoolean(e)?function(n){return"undefined"==typeof n?e:u.$eq(n,function(){return e})}:i.isArray(e)?(r=i.map(e,function(n){return d(n,t)}),function(n){return r.map(function(e){return e(n)})}):i.isObject(e)?(r=i.map(e,function(e,r){var i=d(e,t),c=l(e,r);if(c){var a=n.column.find(c),s=a.values;return function(n){return s}}if(u[r])return function(n){return u[r](n,i)};var f=o.parseAggregatorParams(r);return f?(t=!0,i=d(e,t),function(n){return f.aggregator.apply(null,[i()].concat(f.params))}):function(n){return n=n[r],i(n,i)}}),t?1===r.length?function(n){return r[0](n)}:function(n){return i.map(r,function(e){return e(n)})}:function(n){return u.$and(n,function(n){return i.map(r,function(e){return e(n)})})}):(console.log("no expression found for ",e),!1)}return{filter:e,filterAll:t,applyFilters:a,makeFunction:d,scanForDynamicFilters:f}}},{"./aggregation":31,"./expressions":37,"./lodash":39,q:4}],39:[function(n,e,t){"use strict";function r(n){n=n||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(n[t]=arguments[e][t]);return n}function i(n,e){return n.find(e)}function u(n,e){return n.filter(function(t,r){var i=e(t);return i?(n.splice(r,1),!0):void 0})}function o(n){return Array.isArray(n)}function c(n){return"object"==typeof n&&!o(n)}function a(n){return"boolean"==typeof n}function s(n){return"string"==typeof n}function f(n){return"number"==typeof n}function l(n){return"function"==typeof n}function d(n,e){return o(e)&&(e=e.join(".")),e.replace("[",".").replace("]","").split(".").reduce(function(n,e){return n[e]},n)}function p(n,e,t){if("string"==typeof e&&(e=e.replace("[",".").replace("]","").split(".")),e.length>1){var i=e.shift();r(n[i]="[object Object]"===Object.prototype.toString.call(n[i])?n[i]:{},e,t)}else n[e[0]]=t}function v(n,e){var t,r;if(l(e)){if(c(n)){t=[];for(r in n)n.hasOwnProperty(r)&&t.push(e(n[r],r,n));return t}return n.map(e)}if(c(n)){t=[];for(r in n)n.hasOwnProperty(r)&&t.push(n[r]);return t}return n.map(function(n,t){return n[e]})}function h(n){return Object.keys(n)}function m(n,e){return l(e)?n.sort(function(n,t){return e(n)>e(t)?1:e(n)<e(t)?-1:0}):void 0}function y(n,e){if(!c(n))return o(n)?n.forEach(e):void 0;for(var t in n)n.hasOwnProperty(t)&&e(n[t],t,n)}function g(n){return"undefined"==typeof n}function x(n,e){var t={};return y(e,function(e){"undefined"!=typeof n[e]&&(t[e]=n[e])}),t}function k(n,e){var t=[];return y(n,function(n){return-1===e.indexOf(n)?t.push(n):void 0}),y(e,function(e){return-1===n.indexOf(e)?t.push(e):void 0}),t}function b(n){return JSON.parse(JSON.stringify(n,function(n,e){return"function"==typeof e?e.toString():e}))}function j(n,e){if("object"==typeof n&&null!==n&&"object"==typeof e&&null!==e){if(Object.keys(n).length!=Object.keys(e).length)return!1;for(var t in n){if(!e.hasOwnProperty(t))return!1;if(!j(n[t],e[t]))return!1}return!0}return n===e}function w(n,e){var t=n.length,r=e.length;return t>r?n.splice(r,t-r):r>t&&n.push.apply(n,new Array(r-t)),y(n,function(t,r){n[r]=e[r]}),n}function A(n){var e=new Set;return n.filter(function(n){var t=!1;return e.has(n)||(e.add(n),t=!0),t})}function O(n){for(var e=[],t=0;t<n.length;++t)for(var r=n[t],i=0;i<r.length;++i)e.push(r[i]);return e}function L(n){for(var e=1;e<n.length;e++){for(var t=n[e],r=e;n[r-1]>t;)n[r]=n[r-1],--r;n[r]=t}return n}function S(n){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(n[t]);return e}function R(n,e){function t(n,r){for(var i in n){var u=b(r);if(u.push(i),"object"==typeof n[i]&&null!==n[i])t(n[i],u);else{if(!n.hasOwnProperty(i))continue;e(n[i],i,u)}}}return t(n,[]),n}e.exports={assign:r,find:i,remove:u,isArray:o,isObject:c,isBoolean:a,isString:s,isNumber:f,isFunction:l,get:d,set:p,map:v,keys:h,sortBy:m,forEach:y,isUndefined:g,pick:x,xor:k,clone:b,isEqual:j,replaceArray:w,uniq:A,flatten:O,sort:L,values:S,recurseObject:R}},{}],40:[function(n,e,t){"use strict";function r(n){return n.locked?u.clone(n.data):n.data}var i=n("q"),u=n("./lodash"),o=n("./aggregation");e.exports=function(n){function e(n,e,t){return n.data=r(e),i.resolve(t(n,e))}function t(n,e,t){n.data=r(e),n.data=u.sortBy(n.data,function(n){return n.key}),t&&n.data.reverse()}function c(n,e,t,i){n.data=r(e),u.isUndefined(i)?(i=t||0,t=0):(t=t||0,i=i||n.data.length),n.data=n.data.splice(t,i-t)}function a(n,e,t,i,c,a){n.data=r(e),t=t||0,i=i||n.data.length;var s=n.data.splice(t,i-t),f={key:a||"Other",value:{}};u.recurseObject(c,function(n,e,t){var r=[];u.forEach(s,function(n){r.push(u.get(n.value,t))}),u.set(f.value,t,o.aggregators[n](r))}),n.data.splice(t,0,f);
}function s(n,e,t,i,o){n.data=r(e),t=t||0,i=i||n.data.length;var c={key:[n.data[t].key,n.data[i].key],value:{}};u.recurseObject(o,function(e,r,o){var a=u.clone(o);a.pop(),a.push(r+"Change"),u.set(c.value,a,u.get(n.data[i].value,o)-u.get(n.data[t].value,o))}),n.data=c}function f(n,e,t,i){i=u.isUndefined(i)?0:i,n.data=r(e),u.recurseObject(t,function(e,t,r){var o=u.clone(r),c=u.clone(r),a=u.clone(r);o.pop(),c.pop(),a.pop(),o.push(t+"Change"),c.push(t+"ChangeFromStart"),a.push(t+"ChangeFromEnd");var s=u.get(n.data[0].value,r,i),f=u.get(n.data[n.data.length-1].value,r,i);u.forEach(n.data,function(e,t){var l=n.data[t-1]||n.data[0];u.set(n.data[t].value,o,u.get(e.value,r,i)-(l?u.get(l.value,r,i):i)),u.set(n.data[t].value,c,u.get(e.value,r,i)-s),u.set(n.data[t].value,a,u.get(e.value,r,i)-f)})})}return{post:e,sortByKey:t,limit:c,squash:a,change:s,changeMap:f}}},{"./aggregation":31,"./lodash":39,q:4}],41:[function(n,e,t){"use strict";function r(n){var e,t=new Error;return u.forEach(n,function(n,r){var u,c=n.success||n,a=n.fail,s=n.notify;if(e)u=e.then(function(n){if(!c)return n;var e=c(n);if(!o(e))throw t.message="Task "+r+" did not return a promise.",t;return e},function(n){if(!a)return i.reject(n);var e=a(n);if(!o(e))throw t.message="Fail for task "+r+" did not return a promise.",t;return e},s);else if(u=c(),!o(u))throw t.message="Task "+r+" did not return a promise.",t;e=u}),e||i.when()}var i=n("q"),u=n("./lodash");i.serial=r;var o=function(n){return n&&u.isFunction(n.then)}},{"./lodash":39,q:4}],42:[function(n,e,t){"use strict";var r=n("q"),i=n("./lodash");e.exports=function(e){var t=n("./reductiofy")(e),u=n("./filters")(e),o=n("./postAggregation")(e),c=i.keys(o);return function(n){function a(n){return e.column({key:n.original.groupBy,type:i.isUndefined(n.type)?null:n.type,array:!!n.array}).then(function(){var t=e.column.find(n.original.groupBy);return n.column=t,t.queries.push(n),t.removeListeners.push(function(){return n.clear()}),n})}function s(n){return r.resolve(n.column.dimension.group()).then(function(e){return n.group=e,n})}function f(n){var t=u.scanForDynamicFilters(n.original);return t.length?r.all(i.map(t,function(t){return e.column({key:t,dynamicReference:n.group})})).then(function(){return n}):n}function l(n){var t=e.onDataChange(function(){return d(n)});n.removeListeners.push(t);var r=e.onFilter(function(){return m(n)});return n.removeListeners.push(r),n}function d(n){return p(n).then(v).then(h).then(m)}function p(n){return t(n.original).then(function(e){return n.reducer=e,n})}function v(n){return r.resolve(n.reducer(n.group)).then(function(){return n})}function h(n){return r.resolve(n.group.all()).then(function(e){return n.data=e,n})}function m(n){return n.postAggregations.length>1&&(n.locked=!0),r.all(i.map(n.postAggregations,function(n){return n()})).then(function(){return n})}function y(n,t){function u(e){return i.isUndefined(e)?void(n.locked=!0):void(n.locked=!!e)}function a(){n.locked=!1}function s(){return i.forEach(n.removeListeners,function(n){n()}),r["try"](function(){return n.group.dispose()}).then(function(){return n.column.queries.splice(n.column.queries.indexOf(n),1),n.column.queries.length?void 0:e.clear(n.column.key)}).then(function(){return e})}function f(e){return function(){function t(){return m(u).then(function(){return u})}var i=Array.prototype.slice.call(arguments),u={};return y(u,n),i.unshift(u,n),n.postAggregations.push(function(){r.resolve(e.apply(null,i)).then(t)}),r.resolve(e.apply(null,i)).then(t)}}var l=!1;return t||(t=n,n={},l=!0),i.assign(n,{universe:e,crossfilter:e.cf,parent:t,column:t.column,dimension:t.dimension,group:t.group,reducer:t.reducer,original:t.original,hash:t.hash,removeListeners:[],postAggregations:[],locked:l,lock:u,unlock:a,clear:s}),i.forEach(c,function(e){n[e]=f(o[e])}),n}for(var g=JSON.stringify(n),x=0;x<e.columns.length;x++)for(var k=0;k<e.columns[x].queries.length;k++)if(e.columns[x].queries[k].hash===g)return r["try"](function(){return e.columns[x].queries[k]});var b={original:n,hash:g};return i.isUndefined(b.original)&&(b.original={}),i.isUndefined(b.original.select)&&(b.original.select={$count:!0}),b.original.groupBy=b.original.groupBy||!0,b=y(b),a(b).then(s).then(f).then(l).then(d)}}},{"./filters":38,"./lodash":39,"./postAggregation":40,"./reductiofy":44,q:4}],43:[function(n,e,t){"use strict";function r(n,e){return n.count(!0)}function i(n,e){return n.sum(e)}function u(n,e){return n.avg(e)}function o(n,e){return n.min(e)}function c(n,e){return n.max(e)}function a(n,e){return n.median(e)}function s(n,e){return n.sumOfSq(e)}function f(n,e){return n.std(e)}function l(n,e){return n.valueList(e)}function d(n,e){return n.dataList(!0)}n("./lodash");e.exports={shorthandLabels:{$count:"count",$sum:"sum",$avg:"avg",$min:"min",$max:"max",$med:"med",$sumSq:"sumSq",$std:"std"},aggregators:{$count:r,$sum:i,$avg:u,$min:o,$max:c,$med:a,$sumSq:s,$std:f,$valueList:l,$dataList:d}}},{"./lodash":39}],44:[function(n,e,t){"use strict";var r=n("reductio"),i=n("./lodash"),u=n("./reductioAggregators"),o=(n("./expressions"),n("./aggregation"));e.exports=function(e){var t=n("./filters")(e);return function(n){function e(n,t){var r=i.sortBy(i.map(t,function(n,e){return{key:e,value:n}}),function(n){return u.aggregators[n.key]?0:1});return i.forEach(r,function(t){if(u.aggregators[t.key]){var r=o.makeValueAccessor(t.value);return void(n=u.aggregators[t.key](n,r))}return i.isObject(t.value)?void(n=e(n.value(t.key),t.value)):void console.error("Nested selects must be an object",t.key)})}var c=r();n.groupBy;if(e(c,n.select),n.filter){var a=t.makeFunction(n.filter);a&&c.filter(a)}return Promise.resolve(c)}}},{"./aggregation":31,"./expressions":37,"./filters":38,"./lodash":39,"./reductioAggregators":43,reductio:24}],45:[function(n,e,t){"use strict";function r(e,t){function r(n){return o.dataListeners.push(n),function(){o.dataListeners.splice(o.dataListeners.indexOf(n),1)}}function u(n){return o.filterListeners.push(n),function(){o.filterListeners.splice(o.filterListeners.indexOf(n),1)}}var o={options:i.assign({},t),columns:[],filters:{},dataListeners:[],filterListeners:[]},c=n("./crossfilter")(o);return e=c.generateColumns(e),c.build(e).then(function(e){return o.cf=e,i.assign(o,{add:c.add,remove:c.remove,column:n("./column")(o),query:n("./query")(o),filter:n("./filters")(o).filter,clear:n("./clear")(o),destroy:n("./destroy")(o),onDataChange:r,onFilter:u})})}n("./q.serial");var i=(n("q"),n("./lodash"));e.exports=r},{"./clear":32,"./column":33,"./crossfilter":34,"./destroy":35,"./filters":38,"./lodash":39,"./q.serial":41,"./query":42,q:4}]},{},[45])(45)});